<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Host Details</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #ffe6f0, #ffcce5);
      color: #333;
      padding: 20px;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background: white;
      border-radius: 15px;
      box-shadow: 0 0 15px rgba(255, 92, 167, 0.3);
      overflow: hidden;
      margin-bottom: 20px;
    }
    .header {
      background-color: #ff5ca7;
      padding: 20px;
      color: white;
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
    }
    .profile {
      text-align: center;
      padding: 20px;
    }
    .profile img {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      border: 4px solid #ff5ca7;
      object-fit: cover;
    }
    .status-row { display:flex; gap:12px; align-items:center; }
    .badge { display:inline-block; padding:4px 10px; border-radius:12px; font-size:12px; font-weight:600; }
    .badge-success { background:#e6f4ea; color:#137333; }
    .badge-warning { background:#fff4e5; color:#b26a00; }
    .info { padding: 0 30px 30px; }
    .info-item { margin: 15px 0; font-size: 1.1rem; }
    .label { font-weight: bold; color: #ff5ca7; }

    /* ID Card and Videos */
    .media-section { padding: 20px; text-align: center; }
    .media-section img {
      max-width: 40%;
      border: 3px solid #ff5ca7;
      border-radius: 10px;
    }
    .video-gallery video {
      width: 30%;
      margin: 10px 3px;
      border: 3px solid #ff5ca7;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">Host Details</div>
    <div class="profile">
      <img src="https://via.placeholder.com/120" alt="Host Picture" id="hostPic" />
    </div>
    <div class="info">
      <div class="info-item"><span class="label">Name:</span> <span id="hostName">Loading...</span></div>
      <div class="info-item"><span class="label">Date of Birth:</span> <span id="hostDOB">Loading...</span></div>
      <div class="info-item"><span class="label">Phone:</span> <span id="hostPhone">Loading...</span></div>
      <div class="info-item status-row"><span class="label">KYC:</span> <span id="kycBadge"></span></div>
    </div>
  </div>

  <div class="container">
    <div class="header">ID Card Photo</div>
    <div class="media-section">
      <img src="https://via.placeholder.com/300x200" alt="ID Card" id="idCardPic" />
    </div>
  </div>

  <div class="container">
    <div class="header">Videos</div>
    <div class="media-section video-gallery" id="videoGallery">
      <p>No videos available</p>
    </div>
  </div>

  <script>
    function getUserIdFromURL() {
      const params = new URLSearchParams(window.location.search);
      return params.get('user_id');
    }

    async function loadHostDetails() {
      const userId = getUserIdFromURL();
      if (!userId) {
        alert("User ID not found in URL.");
        return;
      }

      try {
        const response = await fetch("https://clientfriendclub.com/api/v1/host-details-by-id-for-admin", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ user_id: Number(userId) })
        });

        const result = await response.json();
        console.log("API result:", result);

        if (result.success && result.data) {
          const data = result.data;

          // Profile Photo
          const profilePhoto = data.Images?.find(img => img.image_type === "profile_photo");
          document.getElementById("hostPic").src = profilePhoto?.url || "https://via.placeholder.com/120";

          // ID Card Photo
          const idCardPhoto = data.Images?.find(img => img.image_type === "id_card_photo");
          document.getElementById("idCardPic").src = idCardPhoto?.url || "https://via.placeholder.com/300x200";

          // KYC Badge
          const kycCompleted = Boolean(idCardPhoto?.url);
          const badgeCls = kycCompleted ? 'badge-success' : 'badge-warning';
          const badgeText = kycCompleted ? 'Completed' : 'Pending';
          document.getElementById('kycBadge').innerHTML = `<span class="badge ${badgeCls}">${badgeText}</span>`;

          // Host Info
          document.getElementById("hostName").textContent = data.name || "N/A";
          document.getElementById("hostDOB").textContent = data.dob || "N/A";
          document.getElementById("hostPhone").textContent = data.phone || "N/A";

          // Videos
          const videoGallery = document.getElementById("videoGallery");
          videoGallery.innerHTML = "";
          if (data.Videos && data.Videos.length > 0) {
            data.Videos.forEach(video => {
              if (video.url) {
                const vidElem = document.createElement("video");
                vidElem.src = video.url;
                vidElem.controls = true;
                videoGallery.appendChild(vidElem);
              }
            });
          } else {
            videoGallery.innerHTML = "<p>No videos available</p>";
          }
        } else {
          alert("Host data not found.");
        }
      } catch (error) {
        console.error("Error fetching host details:", error);
        alert("Failed to load host details.");
      }
    }

    window.onload = loadHostDetails;
  </script>
</body>
</html>
